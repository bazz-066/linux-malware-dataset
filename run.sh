source /home/kosim/TA/bin/activate

base_name="/home/kosim/elfs"
res_path="/home/kosim/elfs/done"
elf2014="${base_name}/elf2014"
elf2019="${base_name}/elf2019"
benign="${base_name}/benign"
log="/home/kosim/run.log"
i=0

for dir in "$base_name/"*; do
	if [ "$dir" ==  "$elf2019" ]
	then
		for filepath in "$elf2019/"*; do
			echo -e "${i}: $(date)\tSubmitting ${filepath}" >> $log
			cuckoo submit ${filepath}
			IFS='/' read -a Temp <<< "$filepath"
			filename="${Temp[-1]}"
			sleep 40s
			echo -e "${i}: $(date): Moving ${filepath} to ${res_path}/elf2019/${filename}" >> $log
			cp $filepath "${res_path}/elf2019/${filename}"
			((i++))
			done
	fi
	if [ "$dir" == "$benign" ]
	then
		for filepath in "$benign/"*; do
			echo-e "${i}: $(date): \tSubmitting ${filepath}" >> $log
			cuckoo submit ${filepath}
			IFS='/' read -a Temp <<< "$filepath"
			filename="${Temp[-1]}"
			sleep 40s
			echo -e "${i}: $(date): Moving ${filepath} to ${res_path}/benign/${filename}" >> $log
			cp $filepath "${res_path}/benign/${filename}"
			((i++))
		done
	fi
done

deactivate
